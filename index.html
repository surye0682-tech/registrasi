<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: Arial, sans-serif; padding: 20px; }
      input, textarea { display: block; margin: 10px 0; width: 100%; padding: 8px; }
      button { padding: 10px 20px; background: #4CAF50; color: white; border: none; cursor: pointer; }
      button:hover { background: #45a049; }
    </style>
  </head>
  <body>
    <h2>Form Registrasi</h2>
    <form id="myForm">
      <label>Nama:</label>
      <input type="text" name="nama" required>
      
      <label>Email:</label>
      <input type="email" name="email" required>
      
      <label>Pesan:</label>
      <textarea name="pesan"></textarea>
      
      <button type="submit">Kirim</button>
    </form>
    <p id="status"></p>

    <script>
      const form = document.getElementById("myForm");
      form.addEventListener("submit", e => {
        e.preventDefault();
        const data = {
          nama: form.nama.value,
          email: form.email.value,
          pesan: form.pesan.value
        };
        google.script.run.withSuccessHandler(msg => {
          document.getElementById("status").innerText = msg;
          form.reset();
        }).simpanData(data);
      });
      function doGet(e) {
  return HtmlService.createHtmlOutputFromFile('form');
}

// Proses simpan data
function simpanData(formData) {
  var ss = SpreadsheetApp.openById("13MFtzgpkwDa57m10eJzt3Bk78GGsJcfeh6P3GQekzLU"); // ganti dengan ID spreadsheet
  var sheet = ss.getSheetByName("database"); // ganti nama sheet sesuai punya kamu
  sheet.appendRow([new Date(), formData.nama, formData.email, formData.pesan]);
  return "Data berhasil disimpan!";
}
    </script>
  </body>
</html>
